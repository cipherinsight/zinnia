from zinnia import *


def test_simple_linspace():
    @zk_circuit
    def foo():
        ary = np.linspace(0, 1, 9, dtype=float, endpoint=True)
        assert ary.tolist() == [0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0]

        ary = np.linspace(0, 10, 10, dtype=int, endpoint=False)
        assert ary.tolist() == [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

    assert foo()


def test_complex_linspace():
    @zk_circuit
    def foo():
        ary = np.linspace([[0, 0], [0, 0]], 1, 11, axis=2, dtype=float, endpoint=True)
        assert ary.tolist() == [[[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0], [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]], [[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0], [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]]]

        ary = np.linspace([[0, 0], [0, 0]], 1, 10, axis=1, dtype=float, endpoint=True)
        assert ary.tolist() == [[[0.0, 0.0], [0.1111111111111111, 0.1111111111111111], [0.2222222222222222, 0.2222222222222222], [0.3333333333333333, 0.3333333333333333], [0.4444444444444444, 0.4444444444444444], [0.5555555555555556, 0.5555555555555556], [0.6666666666666666, 0.6666666666666666], [0.7777777777777777, 0.7777777777777777], [0.8888888888888888, 0.8888888888888888], [1.0, 1.0]], [[0.0, 0.0], [0.1111111111111111, 0.1111111111111111], [0.2222222222222222, 0.2222222222222222], [0.3333333333333333, 0.3333333333333333], [0.4444444444444444, 0.4444444444444444], [0.5555555555555556, 0.5555555555555556], [0.6666666666666666, 0.6666666666666666], [0.7777777777777777, 0.7777777777777777], [0.8888888888888888, 0.8888888888888888], [1.0, 1.0]]]

        ary = np.linspace([[0, 0], [0, 0]], 1, 9, axis=2, dtype=float, endpoint=False)
        assert ary.tolist() == [[[0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.4444444444444444, 0.5555555555555556, 0.6666666666666666, 0.7777777777777777, 0.8888888888888888], [0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.4444444444444444, 0.5555555555555556, 0.6666666666666666, 0.7777777777777777, 0.8888888888888888]], [[0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.4444444444444444, 0.5555555555555556, 0.6666666666666666, 0.7777777777777777, 0.8888888888888888], [0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.4444444444444444, 0.5555555555555556, 0.6666666666666666, 0.7777777777777777, 0.8888888888888888]]]
